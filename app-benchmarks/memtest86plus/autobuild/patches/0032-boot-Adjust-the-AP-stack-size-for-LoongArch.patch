From 42e66f52f6acf1be5d8a86dc07301cb9d87266bc Mon Sep 17 00:00:00 2001
From: Chao Li <lichao@loongson.cn>
Date: Thu, 13 Jun 2024 15:31:07 +0800
Subject: [PATCH 32/43] boot: Adjust the AP stack size for LoongArch

LoongArch exception will store all of the GP, FP and CSR on stack, it
need more stack size, make LoongArch AP using 2KB stack size.

Signed-off-by: Chao Li <lichao@loongson.cn>
---
 boot/boot.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/boot/boot.h b/boot/boot.h
index ddbb4d4..8f6432e 100644
--- a/boot/boot.h
+++ b/boot/boot.h
@@ -20,7 +20,11 @@
 #define	MAX_APS		255		/* Maximum number of active APs */
 
 #define BSP_STACK_SIZE	16384		/* Stack size for the BSP */
+#ifdef __loongarch_lp64
+#define AP_STACK_SIZE	2048		/* Stack size for each AP */
+#else
 #define AP_STACK_SIZE	1024		/* Stack size for each AP */
+#endif
 
 #define	STACKS_SIZE	(BSP_STACK_SIZE + MAX_APS * AP_STACK_SIZE)
 
-- 
2.43.4

