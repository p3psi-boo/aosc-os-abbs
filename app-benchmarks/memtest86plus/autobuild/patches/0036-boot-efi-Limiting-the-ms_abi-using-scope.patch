From d2065fda2b8a02d7ca39a3b1cf1d15de3b9227ae Mon Sep 17 00:00:00 2001
From: Chao Li <lichao@loongson.cn>
Date: Tue, 18 Jun 2024 10:33:42 +0800
Subject: [PATCH 36/43] boot/efi: Limiting the ms_abi using scope

Make the ms_abi only work on i386 and x64.

Signed-off-by: Chao Li <lichao@loongson.cn>
---
 boot/efi.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/boot/efi.h b/boot/efi.h
index 1340fa3..1a4efb8 100644
--- a/boot/efi.h
+++ b/boot/efi.h
@@ -70,7 +70,11 @@
 #define EFI_SYSTEM_TABLE_SIGNATURE      UINT64_C(0x5453595320494249)
 #define EFI_RUNTIME_SERVICES_SIGNATURE  UINT64_C(0x5652453544e5552)
 
+#if defined(__x86_64__) || defined(__i386__)
 #define efiapi __attribute__((ms_abi))
+#else
+#define efiapi
+#endif
 
 #ifdef CONFIG_64BIT
 typedef uint64_t        uintn_t;
-- 
2.43.4

